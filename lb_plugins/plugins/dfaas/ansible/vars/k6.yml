---
# Centralized k6 installation variables for DFaaS plugin.
# Used by: setup_global.yml, setup_k6.yml
# Required by: tasks/install_k6.yml

# Workspace configuration
k6_workspace_root: >-
  {{
    (ansible_user == 'root')
    | ternary('/root/.dfaas-k6', '/home/' ~ ansible_user ~ '/.dfaas-k6')
  }}

# APT repository configuration
k6_keyring_path: "/usr/share/keyrings/k6-archive-keyring.gpg"
k6_keyserver: "hkp://keyserver.ubuntu.com:80"
k6_key_fingerprint: "C5AD17C747E3415A3642D57D77C6C491D6AC1D69"
k6_repo: "deb [signed-by={{ k6_keyring_path }}] https://dl.k6.io/deb stable main"

# Version and architecture
k6_version: "0.49.0"
k6_arch_map:
  x86_64: "amd64"
  amd64: "amd64"
  aarch64: "arm64"
  arm64: "arm64"
k6_arch: "{{ k6_arch_map.get(ansible_facts['architecture'], 'amd64') }}"

# Tarball fallback URLs (used when APT install fails)
k6_tarball_url: "https://github.com/grafana/k6/releases/download/v{{ k6_version }}/k6-v{{ k6_version }}-linux-{{ k6_arch }}.tar.gz"
k6_tarball_url_fallback: "https://dl.k6.io/releases/k6-v{{ k6_version }}-linux-{{ k6_arch }}.tar.gz"
k6_extract_dir: "/tmp/k6-v{{ k6_version }}-linux-{{ k6_arch }}"
