queries:
  - name: cpu_usage_node
    query: '100 * sum(1 - rate(node_cpu_seconds_total{mode="idle"}[{time_span}]))'
    range: true
    step: "10s"

  - name: ram_usage_node
    query: 'avg(avg_over_time(node_memory_MemTotal_bytes[{time_span}]) - avg_over_time(node_memory_MemAvailable_bytes[{time_span}]))'
    range: true
    step: "10s"

  - name: ram_usage_node_pct
    query: '100 * avg(1 - ((avg_over_time(node_memory_MemFree_bytes[{time_span}]) + avg_over_time(node_memory_Cached_bytes[{time_span}]) + avg_over_time(node_memory_Buffers_bytes[{time_span}])) / avg_over_time(node_memory_MemTotal_bytes[{time_span}])))'
    range: true
    step: "10s"

  - name: power_usage_node
    query: 'avg_over_time(scaph_host_power_microwatts[{time_span}])'
    range: true
    step: "10s"
    enabled_if: scaphandre

  - name: ram_usage_function
    query: 'avg_over_time(container_memory_usage_bytes{id=~"^/kubepods.*", container_label_io_kubernetes_container_name="{function_name}"}[{time_span}])'
    range: true
    step: "10s"

  - name: cpu_usage_function
    query: '100 * sum(rate(container_cpu_usage_seconds_total{id=~"^/kubepods.*", container_label_io_kubernetes_container_name="{function_name}"}[{time_span}]))'
    range: true
    step: "10s"

  - name: power_usage_function
    query: 'sum(avg_over_time(scaph_process_power_consumption_microwatts{pid=~"{pid_regex}"}[{time_span}]))'
    range: true
    step: "10s"
    enabled_if: scaphandre
