================================================
  NLOC    CCN   token  PARAM  length  location  
------------------------------------------------
       2      1     14      1       3 success@31-33@lb_controller/models/types.py
      11      1     65      7      12 run_playbook@54-65@lb_controller/models/types.py
      13      4     78      4      14 pending_hosts_for@11-24@lb_controller/models/pending.py
      15      5     96      4      16 pending_repetitions@27-42@lb_controller/models/pending.py
      12      5     69      4      13 pending_exists@45-57@lb_controller/models/pending.py
       5      1     56      1       5 __init__@104-108@lb_controller/models/state.py
       3      1     16      1       3 state@111-113@lb_controller/models/state.py
       3      1     19      1       3 reason@116-118@lb_controller/models/state.py
       3      1     18      1       3 is_terminal@120-122@lb_controller/models/state.py
       6      1     27      1       6 allows_cleanup@124-129@lb_controller/models/state.py
       4      1     32      2       5 register_callback@131-135@lb_controller/models/state.py
      19      5    110      3      20 transition@137-156@lb_controller/models/state.py
       3      1     28      1       3 snapshot@158-160@lb_controller/models/state.py
       2      1     19      3       2 __init__@26-27@lb_controller/ansible/callback_plugins/lb_events.py
      33     10    191      1      35 _extract_lb_event@30-64@lb_controller/ansible/callback_plugins/lb_events.py
       6      2     65      1       6 __init__@77-82@lb_controller/ansible/callback_plugins/lb_events.py
       2      1     20      3       2 v2_runner_on_ok@84-85@lb_controller/ansible/callback_plugins/lb_events.py
       2      1     20      3       2 v2_runner_on_failed@87-88@lb_controller/ansible/callback_plugins/lb_events.py
       2      1     20      3       2 v2_runner_on_unreachable@90-91@lb_controller/ansible/callback_plugins/lb_events.py
       2      1     20      3       2 v2_runner_on_skipped@93-94@lb_controller/ansible/callback_plugins/lb_events.py
       6      2     45      3       6 v2_playbook_on_task_start@96-101@lb_controller/ansible/callback_plugins/lb_events.py
       8      4     81      3       8 _handle_result@105-112@lb_controller/ansible/callback_plugins/lb_events.py
       6      3     46      2       6 _events_from_result@114-119@lb_controller/ansible/callback_plugins/lb_events.py
      20     12    172      2      21 _candidate_texts@121-141@lb_controller/ansible/callback_plugins/lb_events.py
       6      2     51      2       7 _write_event@143-149@lb_controller/ansible/callback_plugins/lb_events.py
      24      8    153      4      24 _emit_task_timing@151-174@lb_controller/ansible/callback_plugins/lb_events.py
       3      1     34      3       3 __init__@28-30@lb_controller/ansible/collections/ansible_collections/community/docker/plugins/connection/docker.py
       5      2     25      1       5 _connect@32-36@lb_controller/ansible/collections/ansible_collections/community/docker/plugins/connection/docker.py
      15      3    119      4      15 exec_command@38-52@lb_controller/ansible/collections/ansible_collections/community/docker/plugins/connection/docker.py
       8      2     66      3       8 put_file@54-61@lb_controller/ansible/collections/ansible_collections/community/docker/plugins/connection/docker.py
      10      3     88      3      10 fetch_file@63-72@lb_controller/ansible/collections/ansible_collections/community/docker/plugins/connection/docker.py
      46      6    247      5      49 run_global_setup@24-72@lb_controller/adapters/playbooks.py
      35      6    205     10      36 run_workload_setup@75-110@lb_controller/adapters/playbooks.py
      33      4    158     10      34 run_workload_execution@113-146@lb_controller/adapters/playbooks.py
      49      8    263      8      54 execute_run_playbook@149-202@lb_controller/adapters/playbooks.py
      63      7    289      7      64 handle_collect_phase@205-268@lb_controller/adapters/playbooks.py
      19      4     87      5      20 run_teardown_playbook@271-290@lb_controller/adapters/playbooks.py
      48     12    284      5      52 run_global_teardown@293-344@lb_controller/adapters/playbooks.py
      20      2     99      6      21 run_for_hosts@347-367@lb_controller/adapters/playbooks.py
       3      1     32      2       3 __init__._default_cb@62-64@lb_controller/adapters/ansible_runner.py
      25      4    195      7      43 __init__@26-68@lb_controller/adapters/ansible_runner.py
      83     14    525      7      94 run_playbook@70-163@lb_controller/adapters/ansible_runner.py
      12      3     74      2      14 _prepare_inventory@165-178@lb_controller/adapters/ansible_runner.py
       9      2     33      0      10 _import_runner@181-190@lb_controller/adapters/ansible_runner.py
      21      2    139      8      26 _run_subprocess_playbook@192-217@lb_controller/adapters/ansible_runner.py
      18      3     99      5      18 _build_playbook_cmd@219-236@lb_controller/adapters/ansible_runner.py
       6      1     53      2       6 _write_extravars@238-243@lb_controller/adapters/ansible_runner.py
       4      1     36      1       4 _build_env@246-249@lb_controller/adapters/ansible_runner.py
       3      1     42      2       3 _log_subprocess_command@252-254@lb_controller/adapters/ansible_runner.py
      20      5    149      4      20 _run_streaming_subprocess@256-275@lb_controller/adapters/ansible_runner.py
      18      3    117      3      18 _run_capture_subprocess@277-294@lb_controller/adapters/ansible_runner.py
      28      8    146      3      28 _stream_process_output@296-323@lb_controller/adapters/ansible_runner.py
       6      2     46      2       6 _emit_stream_line@325-330@lb_controller/adapters/ansible_runner.py
       9      3     56      3       9 _finalize_process@332-340@lb_controller/adapters/ansible_runner.py
       5      2     27      2       5 _terminate_process@342-346@lb_controller/adapters/ansible_runner.py
       5      4     37      2       5 _should_stop@348-352@lb_controller/adapters/ansible_runner.py
      15      5     72      1      16 interrupt@354-369@lb_controller/adapters/ansible_runner.py
       5      3     37      1       6 is_running@372-377@lb_controller/adapters/ansible_runner.py
       9      3     69      1      10 _render_inventory@380-389@lb_controller/adapters/ansible_runner.py
      16      3    110      5      22 __init__@19-40@lb_controller/adapters/remote_runner.py
       2      1     13      1       2 state@43-44@lb_controller/adapters/remote_runner.py
       2      1     11      1       2 result@47-48@lb_controller/adapters/remote_runner.py
       2      1     13      1       2 exception@51-52@lb_controller/adapters/remote_runner.py
       5      3     51      1       6 start@54-59@lb_controller/adapters/remote_runner.py
       7      3     47      2       8 wait@61-68@lb_controller/adapters/remote_runner.py
      10      4     54      2      12 arm_stop@70-81@lb_controller/adapters/remote_runner.py
      27     11    154      1      28 _run@83-110@lb_controller/adapters/remote_runner.py
      31      4    208     11      33 __init__@75-107@lb_controller/engine/controller.py
       3      2     25      2       4 on_event@109-112@lb_controller/engine/controller.py
       5      2     51      3       6 _transition@114-119@lb_controller/engine/controller.py
       5      2     36      2       6 _arm_stop@121-126@lb_controller/engine/controller.py
       5      3     31      1       6 _stop_requested@128-133@lb_controller/engine/controller.py
       7      3     35      1       8 _refresh_journal@135-142@lb_controller/engine/controller.py
       2      1     15      1       2 run.ui_log@172-173@lb_controller/engine/controller.py
      32      8    221      6      52 run@144-195@lb_controller/engine/controller.py
      76     12    419      5      82 _prepare_run_state@197-278@lb_controller/engine/controller.py
       8      1     51      5       8 _run_global_setup@280-287@lb_controller/engine/controller.py
      17      4     99      5      18 _run_workloads@289-306@lb_controller/engine/controller.py
      62      8    269      6      69 _process_single_workload@308-376@lb_controller/engine/controller.py
       8      1     49      5       8 _handle_stop_during_workloads@378-385@lb_controller/engine/controller.py
      13      2     57      5      13 _get_plugin_assets@387-399@lb_controller/engine/controller.py
      24      1     94     10      24 _run_workload_setup@401-424@lb_controller/engine/controller.py
      24      1     92     10      24 _run_workload_execution@426-449@lb_controller/engine/controller.py
      20      1     78      8      20 _execute_run_playbook@451-470@lb_controller/engine/controller.py
      18      1     64      7      18 _handle_collect_phase@472-489@lb_controller/engine/controller.py
       8      1     48      5       8 _run_global_teardown@491-498@lb_controller/engine/controller.py
      34      7    166      5      34 _build_summary@500-533@lb_controller/engine/controller.py
       7      1     44      4      14 _handle_stop_protocol@535-548@lb_controller/engine/controller.py
       7      3     31      1       7 _interrupt_executor@550-556@lb_controller/engine/controller.py
       5      2     42      1       7 _collector_apt_packages@558-564@lb_controller/engine/controller.py
       9      1     59      6       9 _run_for_hosts@566-574@lb_controller/engine/controller.py
      19      1     92      5      20 handle_stop_during_workloads@18-37@lb_controller/engine/stop_logic.py
      52      6    233      4      66 handle_stop_protocol@40-105@lb_controller/engine/stop_logic.py
      12      1     73      4      18 __init__@28-45@lb_controller/engine/stops.py
       6      2     40      1       7 initiate_stop@47-53@lb_controller/engine/stops.py
      12      8    107      2      23 process_event@57-79@lb_controller/engine/stops.py
       4      2     33      1       5 _check_completion@81-85@lb_controller/engine/stops.py
       7      4     62      1       9 check_timeout@87-95@lb_controller/engine/stops.py
       2      1     15      1       2 can_proceed_to_teardown@97-98@lb_controller/engine/stops.py
       2      1     16      2       2 start_phase@39-40@lb_controller/engine/lifecycle.py
       4      3     49      1       4 finish@42-45@lb_controller/engine/lifecycle.py
       3      2     23      1       3 arm_stop@47-49@lb_controller/engine/lifecycle.py
       2      1     14      1       2 mark_interrupting_setup@51-52@lb_controller/engine/lifecycle.py
       2      1     14      1       2 mark_waiting_runners@54-55@lb_controller/engine/lifecycle.py
       2      1     14      1       2 mark_teardown@57-58@lb_controller/engine/lifecycle.py
       2      1     14      1       2 mark_interrupting_teardown@60-61@lb_controller/engine/lifecycle.py
       2      1     14      1       2 mark_failed@63-64@lb_controller/engine/lifecycle.py
       2      1     14      1       2 mark_stopped@66-67@lb_controller/engine/lifecycle.py
      10      5     74      2      16 on_sigint@42-57@lb_controller/engine/interrupts.py
       2      1     15      1       3 mark_finished@59-61@lb_controller/engine/interrupts.py
       3      2     24      1       4 reset_arm@63-66@lb_controller/engine/interrupts.py
      13      1     71      5      13 __init__@72-84@lb_controller/engine/interrupts.py
       4      1     33      1       4 __enter__@86-89@lb_controller/engine/interrupts.py
       4      2     40      4       4 __exit__@91-94@lb_controller/engine/interrupts.py
       9      4     62      3       9 _delegate@96-104@lb_controller/engine/interrupts.py
      11      4     75      3      11 _handle_sigint@106-116@lb_controller/engine/interrupts.py
       2      1     10      1       2 key@38-39@lb_controller/services/journal.py
      31      6    180      4      36 initialize@53-88@lb_controller/services/journal.py
       2      1     21      2       2 add_task@90-91@lb_controller/services/journal.py
       5      3     47      2       5 get_tasks_by_host@93-97@lb_controller/services/journal.py
       3      1     36      4       4 get_task@99-102@lb_controller/services/journal.py
      20      4    103      7      20 update_task@104-123@lb_controller/services/journal.py
       5      2     52      4      11 should_run@125-135@lb_controller/services/journal.py
       7      5     83      3       7 _update_task_timings@138-144@lb_controller/services/journal.py
       9      3    100      2      13 save@146-158@lb_controller/services/journal.py
      28     10    192      3      31 load@161-191@lb_controller/services/journal.py
       8      4     45      1      11 rehydrate_config@193-203@lb_controller/services/journal.py
      10      2     72      4      10 __init__@209-218@lb_controller/services/journal.py
       3      1     24      2       4 emit@220-223@lb_controller/services/journal.py
       3      2     25      2       3 emit_many@225-227@lb_controller/services/journal.py
       7      3     30      1       7 close@229-235@lb_controller/services/journal.py
      17      2    107      2      18 _update_journal@237-254@lb_controller/services/journal.py
      21      9    113      2      22 _write_log@256-277@lb_controller/services/journal.py
      10      4     62      1      11 _config_dump@280-290@lb_controller/services/journal.py
       6      2     63      1       7 _config_hash@293-299@lb_controller/services/journal.py
       2      1     18      0       3 generate_run_id@21-23@lb_controller/services/paths.py
       9      1     79      2      13 prepare_run_dirs@26-38@lb_controller/services/paths.py
      11      2     72      3      12 prepare_per_host_dirs@41-52@lb_controller/services/paths.py
       8      4     65      1       9 apply_playbook_defaults@55-63@lb_controller/services/paths.py
      22      2     99      9      23 update_journal_tasks@18-40@lb_controller/services/journal_sync.py
      25      3    105      9      26 update_all_reps@43-68@lb_controller/services/journal_sync.py
      16      4     99      6      17 backfill_timings_from_results@71-87@lb_controller/services/journal_sync.py
       3      2     19      1       4 _refresh_journal@90-93@lb_controller/services/journal_sync.py
      18      6    120      2      19 _collect_results@96-114@lb_controller/services/journal_sync.py
      12      3     69      4      14 _apply_result_entry@117-130@lb_controller/services/journal_sync.py
      12      6    116      2      12 _update_task_timings@133-144@lb_controller/services/journal_sync.py
      10      5     99      2      10 _update_task_status@147-156@lb_controller/services/journal_sync.py
      10      5     85      3      10 _format_error_message@159-168@lb_controller/services/journal_sync.py
       9      3     65      4       9 __init__@20-28@lb_controller/services/run_catalog_service.py
      18      7    117      1      21 list_runs@30-50@lb_controller/services/run_catalog_service.py
      24      6    173      2      29 get_run@52-80@lb_controller/services/run_catalog_service.py
       3      2     37      2       3 _resolve_output_root@82-84@lb_controller/services/run_catalog_service.py
       4      2     35      2       4 _resolve_optional_root@87-90@lb_controller/services/run_catalog_service.py
       4      3     28      1       4 _existing_or_none@93-96@lb_controller/services/run_catalog_service.py
       7      3     44      1       7 _load_journal@99-105@lb_controller/services/run_catalog_service.py
      11      4     73      1      11 _extract_created_at@108-118@lb_controller/services/run_catalog_service.py
      18      7    139      1      18 _extract_hosts_workloads@121-138@lb_controller/services/run_catalog_service.py
       2      3     32      1       2 _fallback_hosts@141-142@lb_controller/services/run_catalog_service.py
      10      5     75      2      10 _fallback_workloads@145-154@lb_controller/services/run_catalog_service.py
       4      2     44      2       5 __init__@29-33@lb_controller/services/setup_service.py
      12      1     64      1      14 _get_local_inventory@35-48@lb_controller/services/setup_service.py
      19      3     97      2      26 provision_global@50-75@lb_controller/services/setup_service.py
      23      6    128      4      29 provision_workload@77-105@lb_controller/services/setup_service.py
      25      6    125      4      31 teardown_workload@107-137@lb_controller/services/setup_service.py
      16      3     85      2      21 teardown_global@139-159@lb_controller/services/setup_service.py
28 file analyzed.
==============================================================
NLOC    Avg.NLOC  AvgCCN  Avg.token  function_cnt    file
--------------------------------------------------------------
      0       0.0     0.0        0.0         0     lb_controller/models/__init__.py
     41       6.5     1.0       39.5         2     lb_controller/models/types.py
     44      13.3     4.7       81.0         3     lb_controller/models/pending.py
     13       0.0     0.0        0.0         0     lb_controller/models/contracts.py
    136       5.8     1.5       38.2         8     lb_controller/models/state.py
    134       9.2     3.7       69.5        13     lb_controller/ansible/callback_plugins/lb_events.py
      0       0.0     0.0        0.0         0     lb_controller/ansible/collections/ansible_collections/community/docker/plugins/connection/__init__.py
     49       8.2     2.2       66.4         5     lb_controller/ansible/collections/ansible_collections/community/docker/plugins/connection/docker.py
      0       0.0     0.0        0.0         0     lb_controller/ansible/collections/ansible_collections/community/docker/plugins/__init__.py
      0       0.0     0.0        0.0         0     lb_controller/ansible/collections/ansible_collections/community/docker/__init__.py
      0       0.0     0.0        0.0         0     lb_controller/ansible/collections/ansible_collections/community/__init__.py
      0       0.0     0.0        0.0         0     lb_controller/ansible/collections/ansible_collections/__init__.py
    328      39.1     6.1      204.0         8     lb_controller/adapters/playbooks.py
    323      15.2     3.5       99.2        20     lb_controller/adapters/ansible_runner.py
     81       8.9     3.4       56.6         8     lb_controller/adapters/remote_runner.py
    481      17.9     3.0       95.2        24     lb_controller/engine/controller.py
     81      35.5     3.5      162.5         2     lb_controller/engine/stop_logic.py
     55       7.2     3.0       55.0         6     lb_controller/engine/stops.py
     43       2.3     1.3       19.1         9     lb_controller/engine/lifecycle.py
     78       7.0     2.5       49.2         8     lb_controller/engine/interrupts.py
    233      10.4     3.4       71.8        19     lb_controller/services/journal.py
     42       7.5     2.0       58.5         4     lb_controller/services/paths.py
    137      14.2     4.0       90.1         9     lb_controller/services/journal_sync.py
      4       0.0     0.0        0.0         0     lb_controller/services/__init__.py
    124      10.0     4.1       74.4        11     lb_controller/services/run_catalog_service.py
    111      16.5     3.5       90.5         6     lb_controller/services/setup_service.py
      0       0.0     0.0        0.0         0     lb_controller/__init__.py
     74       0.0     0.0        0.0         0     lb_controller/api.py

==========================================================================================================
!!!! Warnings (cyclomatic_complexity > 10 or length > 200 or nloc > 1000000 or parameter_count > 100) !!!!
================================================
  NLOC    CCN   token  PARAM  length  location  
------------------------------------------------
      20     12    172      2      21 _candidate_texts@121-141@lb_controller/ansible/callback_plugins/lb_events.py
      48     12    284      5      52 run_global_teardown@293-344@lb_controller/adapters/playbooks.py
      83     14    525      7      94 run_playbook@70-163@lb_controller/adapters/ansible_runner.py
      27     11    154      1      28 _run@83-110@lb_controller/adapters/remote_runner.py
      76     12    419      5      82 _prepare_run_state@197-278@lb_controller/engine/controller.py
==========================================================================================
Total nloc   Avg.NLOC  AvgCCN  Avg.token   Fun Cnt  Warning cnt   Fun Rt   nloc Rt
------------------------------------------------------------------------------------------
      2612      12.9     3.3       80.0      165            5      0.03    0.12
