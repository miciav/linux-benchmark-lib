================================================
  NLOC    CCN   token  PARAM  length  location  
------------------------------------------------
       5      1     34      1       6 controller_stop_hint@14-19@lb_app/services/run_logging.py
      27      7    141      1      27 announce_stop_factory._announce_stop@30-56@lb_app/services/run_logging.py
       8      1     53      4      37 announce_stop_factory@22-58@lb_app/services/run_logging.py
      21      5    106      3      22 log_completion@61-82@lb_app/services/run_logging.py
      36     11    177      4      37 on_controller_state_change@85-121@lb_app/services/run_logging.py
      35      9    151      6      36 emit_warning@124-159@lb_app/services/run_logging.py
       5      2     63      1       6 _slug_phase_label@13-18@lb_app/services/run_output.py
       8      2     40      3       9 format_bullet_line@21-29@lb_app/services/run_output.py
       4      1     34      1       4 __init__@35-38@lb_app/services/run_output.py
       9      3     69      3       9 start@40-48@lb_app/services/run_output.py
       2      1     25      1       2 flush@50-51@lb_app/services/run_output.py
      10      4     69      2      10 _finish@53-62@lb_app/services/run_output.py
      33     10    197      2      39 _extract_lb_event_data@65-103@lb_app/services/run_output.py
      33     10    197      2      37 _extract_lb_task_data@106-142@lb_app/services/run_output.py
      28      1    110      1      30 __init__@148-177@lb_app/services/run_output.py
       2      1     14      2       2 set_phase@179-180@lb_app/services/run_output.py
       8      3     57      5       9 process@182-190@lb_app/services/run_output.py
       8      3     60      5      10 process_timing@192-201@lb_app/services/run_output.py
       3      2     32      4       4 _emit@203-206@lb_app/services/run_output.py
      15      5     96      6      15 _emit_bullet@208-222@lb_app/services/run_output.py
       2      1     14      1       2 _slug_phase@225-226@lb_app/services/run_output.py
       4      2     25      2       4 _should_skip_timing@228-231@lb_app/services/run_output.py
      26     14    167      4      26 _handle_line@233-258@lb_app/services/run_output.py
      15      4     94      4      15 _handle_timing_line@260-274@lb_app/services/run_output.py
       9      2     61      4       9 _maybe_emit_progress@276-284@lb_app/services/run_output.py
      32     13    205      4      32 _maybe_emit_task_timing@286-317@lb_app/services/run_output.py
      19      9    144      4      19 _maybe_emit_msg_line@319-337@lb_app/services/run_output.py
      14      6     75      2      14 _is_noise_line@339-352@lb_app/services/run_output.py
      20      6    133      4      20 _maybe_emit_task@354-373@lb_app/services/run_output.py
       6      2     53      2       6 _parse_task_line@375-380@lb_app/services/run_output.py
      12      7    110      2      12 _parse_task_name@382-393@lb_app/services/run_output.py
       9      3     48      5      10 _should_suppress_task@395-404@lb_app/services/run_output.py
      19      6     98      4      19 _maybe_flush_task_timing@406-424@lb_app/services/run_output.py
       9      2     63      4       9 _maybe_emit_benchmark_start@426-434@lb_app/services/run_output.py
      13      4     68      4      13 _maybe_emit_interesting@436-448@lb_app/services/run_output.py
       7      4     54      4       7 _maybe_emit_error@450-456@lb_app/services/run_output.py
      28     18    231      2      31 _format_progress@458-488@lb_app/services/run_output.py
       3      1     25      2       3 __init__@79-81@lb_app/services/run_service.py
      14      3     89      3      15 _enable_dashboard_log@83-97@lb_app/services/run_service.py
      16      2     79      6      21 get_run_plan@99-119@lb_app/services/run_service.py
      15      7     90      3      16 apply_overrides@122-137@lb_app/services/run_service.py
      25      3    147      9      26 build_context@139-164@lb_app/services/run_service.py
      40      1    227     15      45 create_session@166-210@lb_app/services/run_service.py
      24      7    125      5      25 _load_or_default_config@212-236@lb_app/services/run_service.py
      11      5     62      2      12 _apply_platform_defaults@239-250@lb_app/services/run_service.py
      21      6    118      7      22 _apply_setup_overrides@252-273@lb_app/services/run_service.py
      26      9    153      4      29 _resolve_target_tests@276-304@lb_app/services/run_service.py
       2      1     25      2       2 execute._debug_printer@328-329@lb_app/services/run_service.py
      32      4    140      6      38 execute@306-343@lb_app/services/run_service.py
      76     13    405      8      83 _run_remote@345-427@lb_app/services/run_service.py
      15      2     77      2      18 _attach_controller_jsonl@430-447@lb_app/services/run_service.py
      35      4    172      2      35 _attach_controller_loki@450-484@lb_app/services/run_service.py
      37      3    189      5      38 _prepare_remote_session@486-523@lb_app/services/run_service.py
      29      6    132      4      30 _short_circuit_empty_run@525-554@lb_app/services/run_service.py
       2      1     17      1       2 _build_event_pipeline._timing_sink@572-573@lb_app/services/run_service.py
       2      1     19      1       2 _build_event_pipeline._timing_handler@575-576@lb_app/services/run_service.py
       2      1     25      1       2 _build_event_pipeline.event_from_payload@590-591@lb_app/services/run_service.py
      51      5    245      7      60 _build_event_pipeline@556-615@lb_app/services/run_service.py
      34      5    149      6      35 _run_controller_loop@617-651@lb_app/services/run_service.py
      21      1     99      5      22 _build_controller_runner@653-674@lb_app/services/run_service.py
       8      1     45      3       9 _build_signal_context@676-684@lb_app/services/run_service.py
       2      1     15      0       2 _drive_runner._run_active@696-697@lb_app/services/run_service.py
      33      3    175      6      38 _drive_runner@686-723@lb_app/services/run_service.py
      18      6     88      6      19 _drain_ctrlc_events@725-743@lb_app/services/run_service.py
       8      4     47      0       8 _log_arm_warning._clear_warning@764-771@lb_app/services/run_service.py
      22      3    108      4      32 _log_arm_warning@745-776@lb_app/services/run_service.py
      13      2     76      7      14 _handle_run_completion@778-791@lb_app/services/run_service.py
      36      9    169      5      37 _on_stop_requested@793-829@lb_app/services/run_service.py
      23      5    102      4      24 _attach_and_log_system_info@831-854@lb_app/services/run_service.py
       3      3     30      1       4 _cleanup_signal_context@857-860@lb_app/services/run_service.py
      33     10    235      5      41 _prepare_journal_and_dashboard@862-902@lb_app/services/run_service.py
       4      1     33      3       5 _load_resume_journal@904-908@lb_app/services/run_service.py
       4      1     33      3       5 _initialize_new_journal@910-914@lb_app/services/run_service.py
      16      2     78      5      17 _create_dashboard@916-932@lb_app/services/run_service.py
       7      1     32      4       8 _build_journal_from_results@934-941@lb_app/services/run_service.py
       2      1     17      1       3 _find_latest_journal@944-946@lb_app/services/run_service.py
       2      1     11      0       3 _generate_run_id@949-951@lb_app/services/run_service.py
       2      1     30      2       3 _parse_progress_line@953-955@lb_app/services/run_service.py
       6      3     53      2       7 _fail_running_tasks@958-964@lb_app/services/run_service.py
      37     10    220      2      42 load_resume_journal@18-59@lb_app/services/run_journal.py
       7      3     47      1       8 resolve_resume_path@62-69@lb_app/services/run_journal.py
      17     10    135      2      18 rehydrate_resume_config@72-89@lb_app/services/run_journal.py
      16      7    118      2      17 ensure_resume_tasks@92-108@lb_app/services/run_journal.py
       7      2     63      2       8 initialize_new_journal@111-118@lb_app/services/run_journal.py
      20      7    123      3      21 build_journal_from_results@121-141@lb_app/services/run_journal.py
       7      3     57      2       8 find_results_file@144-151@lb_app/services/run_journal.py
       6      3     43      1       7 load_results_entries@154-160@lb_app/services/run_journal.py
      14      3     77      4      15 apply_result_entry@163-177@lb_app/services/run_journal.py
      12      6    124      2      13 populate_task_times@180-192@lb_app/services/run_journal.py
      27      5    119      5      28 update_task_status_from_result@195-222@lb_app/services/run_journal.py
      13      5     81      1      14 find_latest_journal@225-238@lb_app/services/run_journal.py
      17      8    114      1      18 find_latest_results_run@241-258@lb_app/services/run_journal.py
       6      2     28      1       7 results_exist_for_run@261-267@lb_app/services/run_journal.py
       7      3     51      1       7 _resolve_host_names@270-276@lb_app/services/run_journal.py
      10      5     57      1      10 _latest_results_mtime@279-288@lb_app/services/run_journal.py
       9      3     51      1       9 _journal_sort_key@291-299@lb_app/services/run_journal.py
       7      3     42      1       7 _parse_run_id@302-308@lb_app/services/run_journal.py
       2      1     18      0       3 generate_run_id@311-313@lb_app/services/run_journal.py
      13      2     73      6      14 attach_system_info@13-26@lb_app/services/run_system_info.py
      12      3     78      3      13 collect_system_info@29-41@lb_app/services/run_system_info.py
       7      4     46      2       8 find_system_summary@44-51@lb_app/services/run_system_info.py
       5      1     30      2       6 system_info_candidates@54-59@lb_app/services/run_system_info.py
      11      5     86      1      12 summarize_system_info@62-73@lb_app/services/run_system_info.py
       5      2     27      1       5 load_json@76-80@lb_app/services/run_system_info.py
       7      9    117      1       7 format_os_summary@83-89@lb_app/services/run_system_info.py
      12     10    110      1      12 format_cpu_summary@92-103@lb_app/services/run_system_info.py
       5      5     73      1       5 format_memory_summary@106-110@lb_app/services/run_system_info.py
      14     12    143      1      14 format_disk_summary@113-126@lb_app/services/run_system_info.py
       5      2     19      1       5 to_gib@129-133@lb_app/services/run_system_info.py
      22      6    111      4      23 log_system_info@136-158@lb_app/services/run_system_info.py
       7      3     46      3       7 __init__@30-36@lb_app/services/test_service.py
      39      4    180      2      43 get_multipass_intensity@38-80@lb_app/services/test_service.py
      14      6    120      3      18 select_multipass@82-99@lb_app/services/test_service.py
       2      1     18      0       2 build_multipass_scenario.row_stress_ng@115-116@lb_app/services/test_service.py
       2      1     18      0       2 build_multipass_scenario.row_dd@118-119@lb_app/services/test_service.py
       2      1     18      0       2 build_multipass_scenario.row_fio@121-122@lb_app/services/test_service.py
      43      5    189      3      60 build_multipass_scenario@101-160@lb_app/services/test_service.py
       5      2     24      2       5 __init__@18-22@lb_app/services/doctor_service.py
       6      2     26      2       6 _check_import@24-29@lb_app/services/doctor_service.py
       2      1     21      2       2 _check_command@31-32@lb_app/services/doctor_service.py
       9      4     73      3       9 _build_check_group@34-42@lb_app/services/doctor_service.py
      36      2    249      1      41 check_controller@44-84@lb_app/services/doctor_service.py
      25      6    196      1      34 check_local_tools@86-119@lb_app/services/doctor_service.py
       6      1     54      1       7 check_multipass@121-127@lb_app/services/doctor_service.py
       9      1     75      1      11 check_all@129-139@lb_app/services/doctor_service.py
      17      3     96      2      18 record@102-119@lb_app/services/run_types.py
       3      1     26      3       3 __init__@125-127@lb_app/services/run_types.py
       2      1     13      1       2 live@129-130@lb_app/services/run_types.py
      10      4     67      2      10 add_log@132-141@lb_app/services/run_types.py
       2      1     14      1       2 refresh@143-144@lb_app/services/run_types.py
       2      1     19      2       2 mark_event@146-147@lb_app/services/run_types.py
       4      2     43      3       4 set_warning@149-152@lb_app/services/run_types.py
       4      2     28      1       4 clear_warning@154-157@lb_app/services/run_types.py
       4      2     33      2       4 set_controller_state@159-162@lb_app/services/run_types.py
      10      4     84      2      10 pipeline_output_callback._dashboard_callback@33-42@lb_app/services/run_pipeline.py
      10      3     64      3      23 pipeline_output_callback@22-44@lb_app/services/run_pipeline.py
       8      3     58      2       8 make_ingest_event._ingest@55-62@lb_app/services/run_pipeline.py
       8      1     43      4      18 make_ingest_event@47-64@lb_app/services/run_pipeline.py
      13      4     81      3      14 mirror_event_to_dashboard@67-80@lb_app/services/run_pipeline.py
      22      6    194      3      23 event_from_payload_data@83-105@lb_app/services/run_pipeline.py
      18      4    113      1      18 make_progress_handler._handle_progress@116-133@lb_app/services/run_pipeline.py
       8      1     43      4      28 make_progress_handler@108-135@lb_app/services/run_pipeline.py
      13      6     78      2      13 make_output_tee._tee_output@146-158@lb_app/services/run_pipeline.py
       8      1     65      6      23 make_output_tee@138-160@lb_app/services/run_pipeline.py
       4      2     31      1       4 maybe_start_event_tailer._on_event_payload@176-179@lb_app/services/run_pipeline.py
      17      3    101      4      23 maybe_start_event_tailer@163-185@lb_app/services/run_pipeline.py
      18      3    147      2      19 parse_progress_line@188-206@lb_app/services/run_pipeline.py
      12      1     74      4      12 __init__@19-30@lb_app/services/run_events.py
      14      3     95      1      15 start@32-46@lb_app/services/run_events.py
       4      2     29      1       4 stop@48-51@lb_app/services/run_events.py
      37     13    222      1      43 _run@53-95@lb_app/services/run_events.py
      13      4     89      1      14 hash_config@11-24@lb_app/services/run_config.py
       7      3     80      2       7 __init__@32-38@lb_app/services/config_service.py
       2      1     22      1       3 ensure_home@40-42@lb_app/services/config_service.py
      12      4     89      2      18 open_editor@44-61@lb_app/services/config_service.py
      17      7    122      2      24 resolve_config_path@63-86@lb_app/services/config_service.py
       5      1     35      2       9 _hydrate_config@88-96@lb_app/services/config_service.py
       7      1     39      1       8 create_default_config@98-105@lb_app/services/config_service.py
      11      5     62      2      12 apply_platform_defaults@108-119@lb_app/services/config_service.py
       5      2     52      1       6 load_platform_config@121-126@lb_app/services/config_service.py
       3      1     28      1       4 load_platform_for_write@128-131@lb_app/services/config_service.py
      10      1     54      3      11 set_plugin_enabled@133-143@lb_app/services/config_service.py
      10      2     68      3      11 set_plugin_selection@145-155@lb_app/services/config_service.py
      12      2    114      2      14 load_for_read@157-170@lb_app/services/config_service.py
      18      4    119      3      23 load_for_write@172-194@lb_app/services/config_service.py
      23      6    166      4      28 add_workload@196-223@lb_app/services/config_service.py
      15      3    107      3      20 remove_plugin@225-244@lb_app/services/config_service.py
      15      4    117      5      16 add_remote_host@246-261@lb_app/services/config_service.py
       3      1     32      2       4 write_saved_config_path@263-266@lb_app/services/config_service.py
       2      1     25      1       3 read_saved_config_path@268-270@lb_app/services/config_service.py
       3      2     24      1       4 clear_saved_config_path@272-275@lb_app/services/config_service.py
      13      5     88      1      14 _read_saved_config_path@277-290@lb_app/services/config_service.py
      13      3     76      5      14 build_run_plan@12-25@lb_app/services/run_plan.py
      34      9    200      5      39 build_plan_item@28-66@lb_app/services/run_plan.py
       5      2     26      2       6 safe_get_plugin@69-74@lb_app/services/run_plan.py
      20      7    111      2      21 resolve_workload_config@77-97@lb_app/services/run_plan.py
      10      4     52      1      11 format_plan_details@100-110@lb_app/services/run_plan.py
      15      6     69      1      17 config_to_dict@113-129@lb_app/services/run_plan.py
      26     15    187      1      29 summarize_config_fields@132-160@lb_app/services/run_plan.py
       7      1     41      2       8 status_for_mode@163-170@lb_app/services/run_plan.py
      11      1     50      3      11 from_grafana@42-52@lb_app/services/provision_service.py
       3      1     26      2       3 __init__@58-60@lb_app/services/provision_service.py
      27     11    144      5      27 _resolve_platform_settings@62-88@lb_app/services/provision_service.py
      29      5    132      5      32 _persist_observability_defaults@90-121@lb_app/services/provision_service.py
      72      8    329     11      77 install_loki_grafana@123-199@lb_app/services/provision_service.py
       2      1     21      2       2 remove_loki_grafana@201-202@lb_app/services/provision_service.py
      28      1    106      5      28 status_loki_grafana@204-231@lb_app/services/provision_service.py
       1      1     11      1       2 live@12-13@lb_app/ui_interfaces.py
       1      1     12      2       2 add_log@15-16@lb_app/ui_interfaces.py
       1      1      8      1       2 refresh@18-19@lb_app/ui_interfaces.py
       1      1     12      2       2 mark_event@21-22@lb_app/ui_interfaces.py
       1      1     12      2       2 update@28-29@lb_app/ui_interfaces.py
       1      1      8      1       2 finish@31-32@lb_app/ui_interfaces.py
       1      1     12      2       2 show_info@38-39@lb_app/ui_interfaces.py
       1      1     12      2       2 show_warning@41-42@lb_app/ui_interfaces.py
       1      1     12      2       2 show_error@44-45@lb_app/ui_interfaces.py
       1      1     12      2       2 show_success@47-48@lb_app/ui_interfaces.py
       1      1     28      4       2 show_panel@50-51@lb_app/ui_interfaces.py
       1      1     12      2       2 show_rule@53-54@lb_app/ui_interfaces.py
       1      1     29      4       2 show_table@56-57@lb_app/ui_interfaces.py
       1      1     15      2       2 status@59-60@lb_app/ui_interfaces.py
       1      1     16      3       2 create_progress@62-63@lb_app/ui_interfaces.py
       1      1     35      4       2 create_dashboard@65-66@lb_app/ui_interfaces.py
       1      1     26      3       2 prompt_multipass_scenario@68-69@lb_app/ui_interfaces.py
       2      1     12      2       2 update@75-76@lb_app/ui_interfaces.py
       2      1      8      1       2 finish@78-79@lb_app/ui_interfaces.py
       2      1     14      1       2 live@85-86@lb_app/ui_interfaces.py
       2      1     12      2       2 add_log@88-89@lb_app/ui_interfaces.py
       2      1      8      1       2 refresh@91-92@lb_app/ui_interfaces.py
       2      1     12      2       2 mark_event@94-95@lb_app/ui_interfaces.py
       2      1     12      2       2 show_info@101-102@lb_app/ui_interfaces.py
       2      1     12      2       2 show_warning@104-105@lb_app/ui_interfaces.py
       2      1     12      2       2 show_error@107-108@lb_app/ui_interfaces.py
       2      1     12      2       2 show_success@110-111@lb_app/ui_interfaces.py
       2      1     28      4       2 show_panel@113-114@lb_app/ui_interfaces.py
       2      1     12      2       2 show_rule@116-117@lb_app/ui_interfaces.py
       2      1     29      4       2 show_table@119-120@lb_app/ui_interfaces.py
       2      1     18      2       2 status@122-123@lb_app/ui_interfaces.py
       2      1     19      3       2 create_progress@125-126@lb_app/ui_interfaces.py
       2      1     38      4       2 create_dashboard@128-129@lb_app/ui_interfaces.py
       2      1     27      3       2 prompt_multipass_scenario@131-132@lb_app/ui_interfaces.py
       8      1     55      1       8 __init__@31-38@lb_app/client.py
       3      1     31      2       3 load_config@40-42@lb_app/client.py
       3      1     29      3       3 save_config@44-46@lb_app/client.py
       2      1     23      2       2 list_runs@48-49@lb_app/client.py
       8      1     58      4       8 get_run_plan@51-58@lb_app/client.py
      59     10    297      6      60 _provision@60-119@lb_app/client.py
      38     17    208      2      41 _resume_node_names@122-162@lb_app/client.py
       2      1     21      2       2 start_run._output_cb@210-211@lb_app/client.py
      59     13    341      3      67 start_run@164-230@lb_app/client.py
      26      1    118     11      26 install_loki_grafana@232-257@lb_app/client.py
       2      1     25      2       2 remove_loki_grafana@259-260@lb_app/client.py
      14      1     58      5      14 status_loki_grafana@262-275@lb_app/client.py
21 file analyzed.
==============================================================
NLOC    Avg.NLOC  AvgCCN  Avg.token  function_cnt    file
--------------------------------------------------------------
    138      22.0     5.7      110.3         6     lb_app/services/run_logging.py
    421      13.3     4.9       87.3        31     lb_app/services/run_output.py
    847      18.5     3.5       99.7        42     lb_app/services/run_service.py
     17       0.0     0.0        0.0         0     lb_app/services/doctor_types.py
    251      12.7     4.7       82.5        19     lb_app/services/run_journal.py
    124       9.8     5.1       76.1        12     lb_app/services/run_system_info.py
    122      15.6     3.0       84.1         7     lb_app/services/test_service.py
    106      12.2     2.4       89.8         8     lb_app/services/doctor_service.py
     24       0.0     0.0        0.0         0     lb_app/services/__init__.py
    120       5.3     1.9       37.7         9     lb_app/services/run_types.py
    166      12.1     3.2       84.8        13     lb_app/services/run_pipeline.py
     76      16.8     4.8      105.0         4     lb_app/services/run_events.py
     17      13.0     4.0       89.0         1     lb_app/services/run_config.py
    216       9.7     2.8       72.2        20     lb_app/services/config_service.py
    135      16.2     5.9       95.2         8     lb_app/services/run_plan.py
    201      24.6     4.0      115.4         7     lb_app/services/provision_service.py
     59       0.0     0.0        0.0         0     lb_app/interfaces.py
     60       1.5     1.0       16.4        34     lb_app/ui_interfaces.py
    246      18.7     4.1      105.3        12     lb_app/client.py
      0       0.0     0.0        0.0         0     lb_app/__init__.py
     92       0.0     0.0        0.0         0     lb_app/api.py

==========================================================================================================
!!!! Warnings (cyclomatic_complexity > 10 or length > 200 or nloc > 1000000 or parameter_count > 100) !!!!
================================================
  NLOC    CCN   token  PARAM  length  location  
------------------------------------------------
      36     11    177      4      37 on_controller_state_change@85-121@lb_app/services/run_logging.py
      26     14    167      4      26 _handle_line@233-258@lb_app/services/run_output.py
      32     13    205      4      32 _maybe_emit_task_timing@286-317@lb_app/services/run_output.py
      28     18    231      2      31 _format_progress@458-488@lb_app/services/run_output.py
      76     13    405      8      83 _run_remote@345-427@lb_app/services/run_service.py
      14     12    143      1      14 format_disk_summary@113-126@lb_app/services/run_system_info.py
      37     13    222      1      43 _run@53-95@lb_app/services/run_events.py
      26     15    187      1      29 summarize_config_fields@132-160@lb_app/services/run_plan.py
      27     11    144      5      27 _resolve_platform_settings@62-88@lb_app/services/provision_service.py
      38     17    208      2      41 _resume_node_names@122-162@lb_app/client.py
      59     13    341      3      67 start_run@164-230@lb_app/client.py
==========================================================================================
Total nloc   Avg.NLOC  AvgCCN  Avg.token   Fun Cnt  Warning cnt   Fun Rt   nloc Rt
------------------------------------------------------------------------------------------
      3438      12.6     3.5       77.8      233           11      0.05    0.14
