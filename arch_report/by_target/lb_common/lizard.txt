================================================
  NLOC    CCN   token  PARAM  length  location  
------------------------------------------------
       4      2     41      1       9 parse_bool_env@6-14@lb_common/config/env.py
       7      3     37      1      11 parse_int_env@17-27@lb_common/config/env.py
       7      3     37      1      11 parse_float_env@30-40@lb_common/config/env.py
      15      6    100      1      20 parse_labels_env@43-62@lb_common/config/env.py
      15      4     97      1      16 discover_entrypoints@13-28@lb_common/discovery/entrypoints.py
      15      3     85      3      16 load_entrypoint@31-46@lb_common/discovery/entrypoints.py
      11      3     76      3      12 load_pending_entrypoints@49-60@lb_common/discovery/entrypoints.py
      10      2     96      2      11 from_object@22-32@lb_common/models/hosts.py
       5      3     46      2       5 _validate_http_url@13-17@lb_common/observability/grafana_client.py
       4      1     24      1       4 __post_init__@33-36@lb_common/observability/grafana_client.py
       6      2     52      1       6 health_check@38-43@lb_common/observability/grafana_client.py
      50      7    272      8      51 upsert_datasource@45-95@lb_common/observability/grafana_client.py
      19      2     91      4      19 import_dashboard@97-115@lb_common/observability/grafana_client.py
       9      3     57      2      10 get_dashboard_by_uid@117-126@lb_common/observability/grafana_client.py
      29      7    168      7      29 create_annotation@128-156@lb_common/observability/grafana_client.py
      25      8    151      3      26 create_service_account_token@158-183@lb_common/observability/grafana_client.py
      31      7    176      4      32 create_api_key@185-216@lb_common/observability/grafana_client.py
      55     18    386      5      56 _request@218-273@lb_common/observability/grafana_client.py
      16      8    117      2      16 _lookup_service_account_id@275-290@lb_common/observability/grafana_client.py
      13      5    108      3      13 _create_service_account_token@292-304@lb_common/observability/grafana_client.py
      10      6     73      1      10 _is_already_exists_error@307-316@lb_common/observability/grafana_client.py
       8      4     50      1       8 _parse_json@319-326@lb_common/observability/grafana_client.py
       4      2     35      2       4 _sleep_backoff@328-331@lb_common/observability/grafana_client.py
       6      2     37      1       7 normalize_loki_endpoint@29-35@lb_common/logs/handlers/loki_handler.py
       5      3     44      2       5 _validate_http_url@38-42@lb_common/logs/handlers/loki_handler.py
      11      3    116      1      12 build_loki_payload@45-56@lb_common/logs/handlers/loki_handler.py
      67      2    426     18      67 __init__@62-128@lb_common/logs/handlers/loki_handler.py
      12      4     64      2      13 emit@130-142@lb_common/logs/handlers/loki_handler.py
      11      3     75      1      12 close@144-155@lb_common/logs/handlers/loki_handler.py
      10      3     72      2      10 _build_entry@157-166@lb_common/logs/handlers/loki_handler.py
       2      1     27      2       2 _build_labels@168-169@lb_common/logs/handlers/loki_handler.py
      41      8    230      2      42 _push_entries@171-212@lb_common/logs/handlers/loki_handler.py
      25      1    138     11      25 __init__@19-43@lb_common/logs/handlers/jsonl_handler.py
      32     11    225      2      32 format@45-76@lb_common/logs/handlers/jsonl_handler.py
      15      1     67      5      16 resolve_jsonl_path@79-94@lb_common/logs/handlers/jsonl_handler.py
      46      1    211     15      46 __init__@100-145@lb_common/logs/handlers/jsonl_handler.py
      45     17    383      2      50 build@30-79@lb_common/logs/handlers/loki_helpers.py
      19     11    157      1      21 run@92-112@lb_common/logs/handlers/loki_helpers.py
      12      5     75      2      12 _resolve_level@26-37@lb_common/logs/core.py
      44      7    232     14      45 build_jsonl_handler@40-84@lb_common/logs/core.py
      76     22    495     18      88 build_loki_handler@87-174@lb_common/logs/core.py
      45      2    244     19      46 attach_loki_handler@177-222@lb_common/logs/core.py
      36      1    187     15      37 attach_jsonl_handler@225-261@lb_common/logs/core.py
      72     12    457      7      83 configure_logging@264-346@lb_common/logs/core.py
      33      1    173     12      34 from_log_record@32-65@lb_common/logs/schema.py
       2      1     17      1       3 to_json@67-69@lb_common/logs/schema.py
15 file analyzed.
==============================================================
NLOC    Avg.NLOC  AvgCCN  Avg.token  function_cnt    file
--------------------------------------------------------------
     34       8.2     3.5       53.8         4     lb_common/config/env.py
      0       0.0     0.0        0.0         0     lb_common/config/__init__.py
     46      13.7     3.3       86.0         3     lb_common/discovery/entrypoints.py
     15       0.0     0.0        0.0         0     lb_common/models/run_info.py
     23      10.0     2.0       96.0         1     lb_common/models/hosts.py
    303      18.9     5.5      120.4        15     lb_common/observability/grafana_client.py
      2       0.0     0.0        0.0         0     lb_common/observability/__init__.py
    183      18.3     3.2      121.2         9     lb_common/logs/handlers/loki_handler.py
     22       0.0     0.0        0.0         0     lb_common/logs/handlers/__init__.py
    127      29.5     3.5      160.2         4     lb_common/logs/handlers/jsonl_handler.py
     91      32.0    14.0      270.0         2     lb_common/logs/handlers/loki_helpers.py
    303      47.5     8.2      281.7         6     lb_common/logs/core.py
     56      17.5     1.0       95.0         2     lb_common/logs/schema.py
     34       0.0     0.0        0.0         0     lb_common/__init__.py
     38       0.0     0.0        0.0         0     lb_common/api.py

==========================================================================================================
!!!! Warnings (cyclomatic_complexity > 10 or length > 200 or nloc > 1000000 or parameter_count > 100) !!!!
================================================
  NLOC    CCN   token  PARAM  length  location  
------------------------------------------------
      55     18    386      5      56 _request@218-273@lb_common/observability/grafana_client.py
      32     11    225      2      32 format@45-76@lb_common/logs/handlers/jsonl_handler.py
      45     17    383      2      50 build@30-79@lb_common/logs/handlers/loki_helpers.py
      19     11    157      1      21 run@92-112@lb_common/logs/handlers/loki_helpers.py
      76     22    495     18      88 build_loki_handler@87-174@lb_common/logs/core.py
      72     12    457      7      83 configure_logging@264-346@lb_common/logs/core.py
==========================================================================================
Total nloc   Avg.NLOC  AvgCCN  Avg.token   Fun Cnt  Warning cnt   Fun Rt   nloc Rt
------------------------------------------------------------------------------------------
      1277      22.5     5.0      141.9       46            6      0.13    0.29
