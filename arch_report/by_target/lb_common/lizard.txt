================================================
  NLOC    CCN   token  PARAM  length  location  
------------------------------------------------
       4      2     41      1       9 parse_bool_env@6-14@lb_common/config/env.py
       7      3     37      1      11 parse_int_env@17-27@lb_common/config/env.py
       7      3     37      1      11 parse_float_env@30-40@lb_common/config/env.py
      15      6    100      1      20 parse_labels_env@43-62@lb_common/config/env.py
      12      4     82      1      13 discover_entrypoints@13-25@lb_common/discovery/entrypoints.py
      15      3     85      3      16 load_entrypoint@28-43@lb_common/discovery/entrypoints.py
      11      3     76      3      12 load_pending_entrypoints@46-57@lb_common/discovery/entrypoints.py
      10      2     96      2      11 from_object@22-32@lb_common/models/hosts.py
       6      2     52      1       6 health_check@26-31@lb_common/observability/grafana_client.py
      50      7    272      8      51 upsert_datasource@33-83@lb_common/observability/grafana_client.py
      19      2     91      4      19 import_dashboard@85-103@lb_common/observability/grafana_client.py
       9      3     57      2      10 get_dashboard_by_uid@105-114@lb_common/observability/grafana_client.py
      29      7    168      7      29 create_annotation@116-144@lb_common/observability/grafana_client.py
      25      8    151      3      26 create_service_account_token@146-171@lb_common/observability/grafana_client.py
      31      7    176      4      32 create_api_key@173-204@lb_common/observability/grafana_client.py
      53     18    386      5      54 _request@206-259@lb_common/observability/grafana_client.py
      16      8    117      2      16 _lookup_service_account_id@261-276@lb_common/observability/grafana_client.py
      13      5    108      3      13 _create_service_account_token@278-290@lb_common/observability/grafana_client.py
      10      6     73      1      10 _is_already_exists_error@293-302@lb_common/observability/grafana_client.py
       8      4     50      1       8 _parse_json@305-312@lb_common/observability/grafana_client.py
       4      2     35      2       4 _sleep_backoff@314-317@lb_common/observability/grafana_client.py
       5      2     31      1       6 normalize_loki_endpoint@26-31@lb_common/logs/handlers/loki_handler.py
      11      3    116      1      12 build_loki_payload@34-45@lb_common/logs/handlers/loki_handler.py
      49      2    326     18      49 __init__@51-99@lb_common/logs/handlers/loki_handler.py
      12      4     64      2      13 emit@101-113@lb_common/logs/handlers/loki_handler.py
      11      3     75      1      12 close@115-126@lb_common/logs/handlers/loki_handler.py
      10      3     72      2      10 _build_entry@128-137@lb_common/logs/handlers/loki_handler.py
      45     17    383      2      50 _build_labels@139-188@lb_common/logs/handlers/loki_handler.py
      19     11    157      1      21 _run_worker@190-210@lb_common/logs/handlers/loki_handler.py
      39      8    230      2      40 _push_entries@212-251@lb_common/logs/handlers/loki_handler.py
      25      1    138     11      25 __init__@19-43@lb_common/logs/handlers/jsonl_handler.py
      32     11    225      2      32 format@45-76@lb_common/logs/handlers/jsonl_handler.py
      15      1     67      5      16 resolve_jsonl_path@79-94@lb_common/logs/handlers/jsonl_handler.py
      46      1    211     15      46 __init__@100-145@lb_common/logs/handlers/jsonl_handler.py
      12      5     75      2      12 _resolve_level@26-37@lb_common/logs/core.py
      44      7    232     14      45 build_jsonl_handler@40-84@lb_common/logs/core.py
      76     22    495     18      88 build_loki_handler@87-174@lb_common/logs/core.py
      45      2    244     19      46 attach_loki_handler@177-222@lb_common/logs/core.py
      36      1    187     15      37 attach_jsonl_handler@225-261@lb_common/logs/core.py
      72     12    457      7      83 configure_logging@264-346@lb_common/logs/core.py
      33      1    173     12      34 from_log_record@32-65@lb_common/logs/schema.py
       2      1     17      1       3 to_json@67-69@lb_common/logs/schema.py
14 file analyzed.
==============================================================
NLOC    Avg.NLOC  AvgCCN  Avg.token  function_cnt    file
--------------------------------------------------------------
     34       8.2     3.5       53.8         4     lb_common/config/env.py
      0       0.0     0.0        0.0         0     lb_common/config/__init__.py
     43      12.7     3.3       81.0         3     lb_common/discovery/entrypoints.py
     15       0.0     0.0        0.0         0     lb_common/models/run_info.py
     23      10.0     2.0       96.0         1     lb_common/models/hosts.py
    292      21.0     6.1      133.5        13     lb_common/observability/grafana_client.py
      2       0.0     0.0        0.0         0     lb_common/observability/__init__.py
    217      22.3     5.9      161.6         9     lb_common/logs/handlers/loki_handler.py
     22       0.0     0.0        0.0         0     lb_common/logs/handlers/__init__.py
    127      29.5     3.5      160.2         4     lb_common/logs/handlers/jsonl_handler.py
    303      47.5     8.2      281.7         6     lb_common/logs/core.py
     56      17.5     1.0       95.0         2     lb_common/logs/schema.py
     34       0.0     0.0        0.0         0     lb_common/__init__.py
     38       0.0     0.0        0.0         0     lb_common/api.py

==========================================================================================================
!!!! Warnings (cyclomatic_complexity > 10 or length > 200 or nloc > 1000000 or parameter_count > 100) !!!!
================================================
  NLOC    CCN   token  PARAM  length  location  
------------------------------------------------
      53     18    386      5      54 _request@206-259@lb_common/observability/grafana_client.py
      45     17    383      2      50 _build_labels@139-188@lb_common/logs/handlers/loki_handler.py
      19     11    157      1      21 _run_worker@190-210@lb_common/logs/handlers/loki_handler.py
      32     11    225      2      32 format@45-76@lb_common/logs/handlers/jsonl_handler.py
      76     22    495     18      88 build_loki_handler@87-174@lb_common/logs/core.py
      72     12    457      7      83 configure_logging@264-346@lb_common/logs/core.py
==========================================================================================
Total nloc   Avg.NLOC  AvgCCN  Avg.token   Fun Cnt  Warning cnt   Fun Rt   nloc Rt
------------------------------------------------------------------------------------------
      1206      23.6     5.3      149.2       42            6      0.14    0.30
