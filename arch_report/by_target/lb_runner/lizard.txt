================================================
  NLOC    CCN   token  PARAM  length  location  
------------------------------------------------
       6      3     38      2      13 _apply_env_fallbacks@89-101@lb_runner/models/config.py
       4      3     29      1       4 validate_name_not_empty@128-131@lb_runner/models/config.py
      17      5     90      1      18 ansible_host_line@133-150@lb_runner/models/config.py
       3      2     37      1       4 ensure_output_dirs@235-238@lb_runner/models/config.py
       7      4     53      1       7 _validate_remote_hosts_unique@244-250@lb_runner/models/config.py
       2      1     18      2       3 from_json@253-255@lb_runner/models/config.py
       2      1     23      2       4 from_dict@258-261@lb_runner/models/config.py
       2      1     24      2       2 save@263-264@lb_runner/models/config.py
       2      1     22      2       2 load@267-268@lb_runner/models/config.py
       2      1     23      2       3 is_plugin_enabled@298-300@lb_runner/models/config.py
       2      1     24      2       2 save@302-303@lb_runner/models/config.py
       2      1     22      2       2 load@306-307@lb_runner/models/config.py
      12      1     99      1      12 apply_loki_env_fallbacks@16-27@lb_runner/models/loki_env.py
       5      3     57      3       5 _fallback_bool@30-34@lb_runner/models/loki_env.py
       5      3     50      3       5 _fallback_str@37-41@lb_runner/models/loki_env.py
       5      3     57      3       5 _fallback_int@44-48@lb_runner/models/loki_env.py
       5      3     57      3       5 _fallback_float@51-55@lb_runner/models/loki_env.py
       7      3     62      2       7 _merge_labels@58-64@lb_runner/models/loki_env.py
       2      1     17      1       2 to_dict@24-25@lb_runner/models/events.py
       2      1     18      1       2 to_json@27-28@lb_runner/models/events.py
       2      1     20      2       2 emit@34-35@lb_runner/models/events.py
       7      3     64      2       7 __init__@32-38@lb_runner/metric_collectors/registry.py
       8      4     63      2       9 register@40-48@lb_runner/metric_collectors/registry.py
       4      2     34      2       5 available@50-54@lb_runner/metric_collectors/registry.py
      11      4     82      2      11 create_collectors@56-66@lb_runner/metric_collectors/registry.py
       2      1     18      1       3 _discover_entrypoint_plugins@68-70@lb_runner/metric_collectors/registry.py
       4      1     22      1       5 _load_pending_entrypoints@72-76@lb_runner/metric_collectors/registry.py
       4      2     61      4      12 __init__@22-33@lb_runner/metric_collectors/cli_collector.py
      41     12    258      1      55 _collect_metrics@35-89@lb_runner/metric_collectors/cli_collector.py
      29     11    174      2      43 _parse_sar@91-133@lb_runner/metric_collectors/cli_collector.py
       7      3     45      1      14 _validate_environment@135-148@lb_runner/metric_collectors/cli_collector.py
       3      1     42      2      12 _is_tool_available@150-161@lb_runner/metric_collectors/cli_collector.py
       5      2     36      1       5 __getattr__@21-25@lb_runner/metric_collectors/__init__.py
      28     13    384      1      47 aggregate_psutil@10-56@lb_runner/metric_collectors/aggregators.py
      13      7    124      1      24 aggregate_cli@59-82@lb_runner/metric_collectors/aggregators.py
       9      1     90      3      16 __init__@23-38@lb_runner/metric_collectors/_base_collector.py
       2      1     14      1       8 _collect_metrics@41-48@lb_runner/metric_collectors/_base_collector.py
       2      1      9      1       8 _validate_environment@51-58@lb_runner/metric_collectors/_base_collector.py
      12      3     88      1      17 start@60-76@lb_runner/metric_collectors/_base_collector.py
       9      3     62      1      13 stop@78-90@lb_runner/metric_collectors/_base_collector.py
      15      4    112      1      25 _collection_loop@92-116@lb_runner/metric_collectors/_base_collector.py
       3      1     29      1       9 get_data@119-127@lb_runner/metric_collectors/_base_collector.py
       9      3     68      1      17 get_dataframe@129-145@lb_runner/metric_collectors/_base_collector.py
      11      4     81      3      20 save_data@147-166@lb_runner/metric_collectors/_base_collector.py
       3      1     20      1       4 clear_data@168-171@lb_runner/metric_collectors/_base_collector.py
      17      3    148      1      27 get_summary_stats@173-199@lb_runner/metric_collectors/_base_collector.py
       3      1     13      1       4 __enter__@201-204@lb_runner/metric_collectors/_base_collector.py
       2      1     14      2       3 __exit__@206-208@lb_runner/metric_collectors/_base_collector.py
       7      2     65      2       8 _safe_import@15-22@lb_runner/metric_collectors/builtin.py
       7      3     35      1       7 _create_psutil@40-46@lb_runner/metric_collectors/builtin.py
       7      2     38      1       7 _create_cli@49-55@lb_runner/metric_collectors/builtin.py
       2      1     16      0       3 builtin_collectors@75-77@lb_runner/metric_collectors/builtin.py
       2      1     30      3       9 __init__@21-29@lb_runner/metric_collectors/psutil_collector.py
      14      2    104      1      22 _collect_metrics@31-52@lb_runner/metric_collectors/psutil_collector.py
       2      1     10      1       9 _validate_environment@54-62@lb_runner/metric_collectors/psutil_collector.py
       4      1     32      3       4 __init__@27-30@lb_runner/engine/run_scope.py
      13      3     74      2      13 prepare@32-44@lb_runner/engine/run_scope.py
      39      4    294      8      45 __init__@49-93@lb_runner/engine/runner.py
       8      4     54      2       8 _resolve_registry@96-103@lb_runner/engine/runner.py
       6      1     47      1      16 collect_system_info@105-120@lb_runner/engine/runner.py
       2      1     21      2       7 _workload_output_dir@122-128@lb_runner/engine/runner.py
      37      2    152      6      52 _run_single_test@130-181@lb_runner/engine/runner.py
       5      1     50      3       5 _prepare_workload_dirs@183-187@lb_runner/engine/runner.py
       2      1     22      2       2 _resolve_duration@189-190@lb_runner/engine/runner.py
      16      3    110      4      16 _attach_event_logger@192-207@lb_runner/engine/runner.py
      42      3    191      7      45 _execute_generator@209-253@lb_runner/engine/runner.py
       2      1     23      2       2 _prepare_generator@255-256@lb_runner/engine/runner.py
      16      1     46      6      16 _wait_for_generator@258-273@lb_runner/engine/runner.py
      11      5     76      4      11 _cleanup_after_run@275-285@lb_runner/engine/runner.py
      28      3    144     10      28 _finalize_single_test@287-314@lb_runner/engine/runner.py
       2      1     11      1       2 _pre_test_cleanup@316-317@lb_runner/engine/runner.py
      39     11    254      6      54 run_benchmark@319-372@lb_runner/engine/runner.py
      24      2    127      5      24 _prepare_run_scope@374-397@lb_runner/engine/runner.py
      50      7    272      6      53 _run_single_repetition@399-451@lb_runner/engine/runner.py
       9      2     43      4       9 _cleanup_generator@453-461@lb_runner/engine/runner.py
      13      1     64      4      14 _process_results@463-476@lb_runner/engine/runner.py
       4      1     38      5       5 _emit_progress@478-482@lb_runner/engine/runner.py
      10      4     75      1      11 run_all_benchmarks@484-494@lb_runner/engine/runner.py
      17      3     75      4      17 _set_log_phase@496-512@lb_runner/engine/runner.py
      16      4     96      1      18 pre_test_cleanup@18-35@lb_runner/engine/execution.py
      16      4     82      3      17 resolve_duration@38-54@lb_runner/engine/execution.py
       9      3     60      3      10 prepare_generator@57-66@lb_runner/engine/execution.py
       6      3     48      2       7 start_collectors@69-75@lb_runner/engine/execution.py
      31      7    152      6      32 wait_for_generator@78-109@lb_runner/engine/execution.py
      18      7    101      4      20 cleanup_after_run@112-131@lb_runner/engine/execution.py
       5      3     42      3       6 should_log_progress@134-139@lb_runner/engine/execution.py
       3      3     35      1       9 generator_running@142-150@lb_runner/engine/execution.py
      12      2     74      5      12 __init__@19-30@lb_runner/engine/stop_token.py
       7      3     50      1       9 _install_signal_handlers@32-40@lb_runner/engine/stop_token.py
      14      5     82      3      15 _handle_signal@42-56@lb_runner/engine/stop_token.py
       9      4     35      1      10 request_stop@58-67@lb_runner/engine/stop_token.py
      12      6     53      1      13 should_stop@69-81@lb_runner/engine/stop_token.py
       7      3     42      1       8 restore@83-90@lb_runner/engine/stop_token.py
       2      1      9      1       2 __enter__@92-93@lb_runner/engine/stop_token.py
       2      1     18      4       2 __exit__@95-96@lb_runner/engine/stop_token.py
       2      1     19      0       3 generate_run_id@16-18@lb_runner/engine/planning.py
      15      6     81      3      15 select_repetitions@21-35@lb_runner/engine/planning.py
       5      2     40      2       6 resolve_workload@38-43@lb_runner/engine/planning.py
      41     11    208      4      47 resolve_config_input@46-92@lb_runner/engine/planning.py
      11      2     63      5      11 __init__@98-108@lb_runner/engine/planning.py
       2      1     11      1       2 generate_run_id@110-111@lb_runner/engine/planning.py
       6      1     36      3       6 select_repetitions@113-118@lb_runner/engine/planning.py
       2      1     20      2       2 resolve_workload@120-121@lb_runner/engine/planning.py
       6      1     30      3       6 resolve_config_input@123-128@lb_runner/engine/planning.py
      10      2     59      5      10 __init__@18-27@lb_runner/engine/progress.py
       2      1     17      2       3 set_run_id@29-31@lb_runner/engine/progress.py
      25      4    106      5      27 emit@33-59@lb_runner/engine/progress.py
      10      1     47      4      10 set_scope@28-37@lb_runner/services/runner_output_manager.py
       3      2     33      2       3 workload_output_dir@39-41@lb_runner/services/runner_output_manager.py
       2      1     13      1       2 output_root@43-44@lb_runner/services/runner_output_manager.py
       8      3     45      2       8 write_system_info@46-53@lb_runner/services/runner_output_manager.py
       2      1     30      3       2 persist_rep_result@55-56@lb_runner/services/runner_output_manager.py
      14      1     55      5      14 process_results@58-71@lb_runner/services/runner_output_manager.py
       2      1     11      1       2 collect@11-12@lb_runner/services/system_info_service.py
       5      2     37      1       5 _env@29-33@lb_runner/services/async_localrunner.py
       3      2     53      1       3 _event_logging_enabled@36-38@lb_runner/services/async_localrunner.py
       8      4     70      0      15 _configure_logging_level@41-55@lb_runner/services/async_localrunner.py
       6      1     38      2       6 _configure_stream.write@64-69@lb_runner/services/async_localrunner.py
       3      1     17      1       3 _configure_stream.flush@71-73@lb_runner/services/async_localrunner.py
       9      1     61      1      19 _configure_stream@58-76@lb_runner/services/async_localrunner.py
       9      2     62      2       9 _write_status@79-87@lb_runner/services/async_localrunner.py
      18      2    130      1      18 _maybe_daemonize@90-107@lb_runner/services/async_localrunner.py
      83      7    460      0      95 main@110-204@lb_runner/services/async_localrunner.py
      10      3     69      2      11 _run@32-42@lb_runner/services/system_info_collectors.py
       8      3     51      2       9 _json_output@45-53@lb_runner/services/system_info_collectors.py
      11      4     92      0      12 _read_os_release@56-67@lb_runner/services/system_info_collectors.py
      33     14    267      0      35 _collect_cpu@70-104@lb_runner/services/system_info_collectors.py
      20      6    139      0      20 _collect_memory@107-126@lb_runner/services/system_info_collectors.py
      41     13    266      0      41 _collect_disks@129-169@lb_runner/services/system_info_collectors.py
      45     17    276      0      45 _collect_nics@172-216@lb_runner/services/system_info_collectors.py
      15      5    155      0      15 _collect_pci@219-233@lb_runner/services/system_info_collectors.py
      28      9    172      1      28 _collect_smart@236-263@lb_runner/services/system_info_collectors.py
      19      6    121      0      19 _collect_kernel_modules@266-284@lb_runner/services/system_info_collectors.py
      24      5    118      0      27 _collect_services@287-313@lb_runner/services/system_info_collectors.py
      15      6    183      1      17 _calculate_fingerprint@316-332@lb_runner/services/system_info_collectors.py
      52      9    300      0      57 collect_system_info@335-391@lb_runner/services/system_info_collectors.py
      18      7    159      1      18 to_dict@74-91@lb_runner/services/system_info_types.py
       2      1     38      3       2 to_csv_rows.add@97-98@lb_runner/services/system_info_types.py
      46     21    401      1      51 to_csv_rows@93-143@lb_runner/services/system_info_types.py
       3      1     28      2       3 __init__@15-17@lb_runner/services/runner_log_manager.py
       2      2     32      2       2 filter@19-20@lb_runner/services/runner_log_manager.py
      38      5    167      6      38 attach@34-71@lb_runner/services/runner_log_manager.py
      54      6    262      5      55 _attach_loki@73-127@lb_runner/services/runner_log_manager.py
      20      6    151      1      20 sync_loki_env@129-148@lb_runner/services/runner_log_manager.py
       4      2     34      2       4 default@21-24@lb_runner/services/results.py
      25      5    126      6      27 build_rep_result@27-53@lb_runner/services/results.py
       7      3     53      1       7 is_generator_success@56-62@lb_runner/services/results.py
      14      2     76      6      14 collect_metrics@65-78@lb_runner/services/results.py
       6      2     48      2       6 persist_rep_result@81-86@lb_runner/services/results.py
       3      3     39      1       3 merge_results._rep_key@102-104@lb_runner/services/results.py
      24     13    205      2      29 merge_results@89-117@lb_runner/services/results.py
       5      1     62      2       5 persist_results@120-124@lb_runner/services/results.py
      20      4     96      5      20 export_plugin_results@127-146@lb_runner/services/results.py
      11      4    135      3      12 write_outputs@12-23@lb_runner/services/system_info_io.py
      52      9    300      0      57 collect_system_info@57-113@lb_runner/services/system_info.py
       8      1     82      1      10 main@116-125@lb_runner/services/system_info.py
       2      1     16      2       2 __init__@15-16@lb_runner/services/collector_coordinator.py
       2      1     23      2       2 create_collectors@18-19@lb_runner/services/collector_coordinator.py
       6      3     49      3       6 start@21-26@lb_runner/services/collector_coordinator.py
       6      3     49      3       6 stop@28-33@lb_runner/services/collector_coordinator.py
      10      1     54      7      10 collect@35-44@lb_runner/services/collector_coordinator.py
      14      1     59      6      14 __init__@16-29@lb_runner/services/log_handler.py
      19      2    110      2      21 emit@31-51@lb_runner/services/log_handler.py
       5      4     53      1      12 ensure_run_dirs._scope_with_run_id@18-29@lb_runner/services/storage.py
       8      1     70      2      25 ensure_run_dirs@14-38@lb_runner/services/storage.py
       5      2     42      3      13 workload_output_dir@41-53@lb_runner/services/storage.py
      16      4     98      2      17 ensure_runner_log@56-72@lb_runner/services/storage.py
       7      2     55      3       8 write_system_info_artifacts@75-82@lb_runner/services/storage.py
       2      2     22      2       2 __init__@20-21@lb_runner/services/result_persister.py
       2      2     20      2       2 set_run_id@23-24@lb_runner/services/result_persister.py
       2      1     26      3       2 persist_rep_result@26-27@lb_runner/services/result_persister.py
      17      1     69      5      17 process_results@29-45@lb_runner/services/result_persister.py
       8      1     85      1       9 main@12-20@lb_runner/services/system_info_cli.py
       7      1     26      3       7 __init__@15-21@lb_runner/registry.py
       2      1     20      2       2 get@23-24@lb_runner/registry.py
       2      1     29      2       2 available@26-27@lb_runner/registry.py
       2      1     35      3       2 create_generator@29-30@lb_runner/registry.py
       2      1     23      2       2 create_collectors@32-33@lb_runner/registry.py
       2      1     29      2       2 available_collectors@35-36@lb_runner/registry.py
34 file analyzed.
==============================================================
NLOC    Avg.NLOC  AvgCCN  Avg.token  function_cnt    file
--------------------------------------------------------------
    209       4.2     2.0       33.6        12     lb_runner/models/config.py
     48       6.5     2.7       63.7         6     lb_runner/models/loki_env.py
     23       2.0     1.0       18.3         3     lb_runner/models/events.py
      0       0.0     0.0        0.0         0     lb_runner/models/__init__.py
     53       6.0     2.5       47.2         6     lb_runner/metric_collectors/registry.py
     92      16.8     5.8      116.0         5     lb_runner/metric_collectors/cli_collector.py
     13       5.0     2.0       36.0         1     lb_runner/metric_collectors/__init__.py
     44      20.5    10.0      254.0         2     lb_runner/metric_collectors/aggregators.py
    109       7.5     2.1       57.5        13     lb_runner/metric_collectors/_base_collector.py
     56       5.8     2.0       38.5         4     lb_runner/metric_collectors/builtin.py
     24       6.0     1.3       48.0         3     lb_runner/metric_collectors/psutil_collector.py
     31       8.5     2.0       53.0         2     lb_runner/engine/run_scope.py
    418      17.4     2.8       99.5        22     lb_runner/engine/runner.py
    114      13.0     4.2       77.0         8     lb_runner/engine/execution.py
     70       8.1     3.1       45.4         8     lb_runner/engine/stop_token.py
     98      10.0     2.9       56.4         9     lb_runner/engine/planning.py
     44      12.3     2.3       60.7         3     lb_runner/engine/progress.py
     56       6.5     1.5       37.2         6     lb_runner/services/runner_output_manager.py
      5       2.0     1.0       11.0         1     lb_runner/services/system_info_service.py
    166      16.0     2.4      103.1         9     lb_runner/services/async_localrunner.py
    345      24.7     7.7      169.9        13     lb_runner/services/system_info_collectors.py
    120      22.0     9.7      199.3         3     lb_runner/services/system_info_types.py
    132      23.4     4.0      128.0         5     lb_runner/services/runner_log_manager.py
    117      12.0     3.9       82.1         9     lb_runner/services/results.py
     16      11.0     4.0      135.0         1     lb_runner/services/system_info_io.py
    104      30.0     5.0      191.0         2     lb_runner/services/system_info.py
     32       5.2     1.8       38.2         5     lb_runner/services/collector_coordinator.py
     39      16.5     1.5       84.5         2     lb_runner/services/log_handler.py
     47       8.2     2.6       63.6         5     lb_runner/services/storage.py
     34       5.8     1.5       34.2         4     lb_runner/services/result_persister.py
     15       8.0     1.0       85.0         1     lb_runner/services/system_info_cli.py
     23       2.8     1.0       27.0         6     lb_runner/registry.py
      0       0.0     0.0        0.0         0     lb_runner/__init__.py
     52       0.0     0.0        0.0         0     lb_runner/api.py

==========================================================================================================
!!!! Warnings (cyclomatic_complexity > 10 or length > 200 or nloc > 1000000 or parameter_count > 100) !!!!
================================================
  NLOC    CCN   token  PARAM  length  location  
------------------------------------------------
      41     12    258      1      55 _collect_metrics@35-89@lb_runner/metric_collectors/cli_collector.py
      29     11    174      2      43 _parse_sar@91-133@lb_runner/metric_collectors/cli_collector.py
      28     13    384      1      47 aggregate_psutil@10-56@lb_runner/metric_collectors/aggregators.py
      39     11    254      6      54 run_benchmark@319-372@lb_runner/engine/runner.py
      41     11    208      4      47 resolve_config_input@46-92@lb_runner/engine/planning.py
      33     14    267      0      35 _collect_cpu@70-104@lb_runner/services/system_info_collectors.py
      41     13    266      0      41 _collect_disks@129-169@lb_runner/services/system_info_collectors.py
      45     17    276      0      45 _collect_nics@172-216@lb_runner/services/system_info_collectors.py
      46     21    401      1      51 to_csv_rows@93-143@lb_runner/services/system_info_types.py
      24     13    205      2      29 merge_results@89-117@lb_runner/services/results.py
==========================================================================================
Total nloc   Avg.NLOC  AvgCCN  Avg.token   Fun Cnt  Warning cnt   Fun Rt   nloc Rt
------------------------------------------------------------------------------------------
      2749      11.8     3.2       79.2      179           10      0.06    0.17
