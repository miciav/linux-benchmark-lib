/Users/micheleciavotta/Downloads/linux-benchmark-lib/.venv/lib/python3.13/site-packages/opentelemetry/instrumentation/dependencies.py:4: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import (
               
               
┌─────────────┐
│ Scan Status │
└─────────────┘
  Scanning 106 files tracked by git with 1063 Code rules:
                                                                                                                        
  Language      Rules   Files          Origin      Rules                                                                
 ─────────────────────────────        ───────────────────                                                               
  <multilang>      48     105          Community    1063                                                                
  python          243      44                                                                                           
  yaml             31      26                                                                                           
  bash              4       8                                                                                           
  c                 5       1                                                                                           
                                                                                                                        
                    
                    
┌──────────────────┐
│ 17 Code Findings │
└──────────────────┘
                         
    lb_plugins/builtin.py
    ❯❱ python.lang.security.audit.non-literal-import.non-literal-import
          Untrusted user input in `importlib.import_module()` function allows an attacker to load arbitrary
          code. Avoid dynamic values in `importlib.import_module()` or use a whitelist to prevent running  
          untrusted code.                                                                                  
          Details: https://sg.run/y6Jk                                                                     
                                                                                                           
           28┆ mod = importlib.import_module(module_name)
                           
    lb_plugins/installer.py
   ❯❯❱ trailofbits.python.tarfile-extractall-traversal.tarfile-extractall-traversal
          Possible path traversal through `tarfile.open($PATH).extractall()` if the source tar is controlled
          by an attacker                                                                                    
          Details: https://sg.run/2RLD                                                                      
                                                                                                            
          122┆ with tarfile.open(archive_path, "r") as tar_ref:
          123┆     tar_ref.extractall(tmp_path, filter="data")
                                                                         
    lb_plugins/plugins/dfaas/ansible/manifests/prometheus-deployment.yaml
    ❯❱ yaml.kubernetes.security.allow-privilege-escalation-no-securitycontext.allow-privilege-escalation-no-
       securitycontext                                                                                      
          In Kubernetes, each pod runs in its own isolated environment with its own set of security policies. 
          However, certain container images may contain `setuid` or `setgid` binaries that could allow an     
          attacker to perform privilege escalation and gain access to sensitive resources. To mitigate this   
          risk, it's recommended to add a `securityContext` to the container in the pod, with the parameter   
          `allowPrivilegeEscalation` set to `false`. This will prevent the container from running any         
          privileged processes and limit the impact of any potential attacks. By adding a `securityContext` to
          your Kubernetes pod, you can help to ensure that your containerized applications are more secure and
          less vulnerable to privilege escalation attacks.                                                    
          Details: https://sg.run/eleR                                                                        
                                                                                                              
           ▶▶┆ Autofix ▶ securityContext: allowPrivilegeEscalation: false name
           24┆ - name: prometheus
                                         
    lb_plugins/plugins/dfaas/generator.py
    ❯❱ python.lang.security.insecure-hash-algorithms.insecure-hash-algorithm-sha1
          Detected SHA1 hash algorithm which is considered insecure. SHA1 is not collision resistant and is
          therefore not suitable as a cryptographic signature. Use SHA256 or SHA3 instead.                 
          Details: https://sg.run/ydYx                                                                     
                                                                                                           
           ▶▶┆ Autofix ▶ hashlib.sha256(payload.encode("utf-8"))
          144┆ return hashlib.sha1(payload.encode("utf-8")).hexdigest()[:12]
                                                                                    
    lb_plugins/plugins/dfaas/legacy_materials/infrastructure/cadvisor-daemonset.yaml
     ❱ yaml.kubernetes.security.run-as-non-root.run-as-non-root
          When running containers in Kubernetes, it's important to ensure that they  are properly secured to  
          prevent privilege escalation attacks.  One potential vulnerability is when a container is allowed to
          run  applications as the root user, which could allow an attacker to gain  access to sensitive      
          resources. To mitigate this risk, it's recommended to  add a `securityContext` to the container,    
          with the parameter `runAsNonRoot`  set to `true`. This will ensure that the container runs as a non-
          root user,  limiting the damage that could be caused by any potential attacks. By  adding a         
          `securityContext` to the container in your Kubernetes pod, you can  help to ensure that your        
          containerized applications are more secure and  less vulnerable to privilege escalation attacks.    
          Details: https://sg.run/dgP5                                                                        
                                                                                                              
           ▶▶┆ Autofix ▶ spec: securityContext: runAsNonRoot: true #
           29┆ spec:
   
    ❯❱ yaml.kubernetes.security.allow-privilege-escalation-no-securitycontext.allow-privilege-escalation-no-
       securitycontext                                                                                      
          In Kubernetes, each pod runs in its own isolated environment with its own set of security policies. 
          However, certain container images may contain `setuid` or `setgid` binaries that could allow an     
          attacker to perform privilege escalation and gain access to sensitive resources. To mitigate this   
          risk, it's recommended to add a `securityContext` to the container in the pod, with the parameter   
          `allowPrivilegeEscalation` set to `false`. This will prevent the container from running any         
          privileged processes and limit the impact of any potential attacks. By adding a `securityContext` to
          your Kubernetes pod, you can help to ensure that your containerized applications are more secure and
          less vulnerable to privilege escalation attacks.                                                    
          Details: https://sg.run/eleR                                                                        
                                                                                                              
           ▶▶┆ Autofix ▶ securityContext: allowPrivilegeEscalation: false name
           32┆ - name: cadvisor
                                                                                         
    lb_plugins/plugins/dfaas/legacy_materials/infrastructure/node-exporter-deamonset.yaml
     ❱ yaml.kubernetes.security.run-as-non-root.run-as-non-root
          When running containers in Kubernetes, it's important to ensure that they  are properly secured to  
          prevent privilege escalation attacks.  One potential vulnerability is when a container is allowed to
          run  applications as the root user, which could allow an attacker to gain  access to sensitive      
          resources. To mitigate this risk, it's recommended to  add a `securityContext` to the container,    
          with the parameter `runAsNonRoot`  set to `true`. This will ensure that the container runs as a non-
          root user,  limiting the damage that could be caused by any potential attacks. By  adding a         
          `securityContext` to the container in your Kubernetes pod, you can  help to ensure that your        
          containerized applications are more secure and  less vulnerable to privilege escalation attacks.    
          Details: https://sg.run/dgP5                                                                        
                                                                                                              
           ▶▶┆ Autofix ▶ spec: securityContext: runAsNonRoot: true #
           19┆ spec:
   
    ❯❱ yaml.kubernetes.security.allow-privilege-escalation-no-securitycontext.allow-privilege-escalation-no-
       securitycontext                                                                                      
          In Kubernetes, each pod runs in its own isolated environment with its own set of security policies. 
          However, certain container images may contain `setuid` or `setgid` binaries that could allow an     
          attacker to perform privilege escalation and gain access to sensitive resources. To mitigate this   
          risk, it's recommended to add a `securityContext` to the container in the pod, with the parameter   
          `allowPrivilegeEscalation` set to `false`. This will prevent the container from running any         
          privileged processes and limit the impact of any potential attacks. By adding a `securityContext` to
          your Kubernetes pod, you can help to ensure that your containerized applications are more secure and
          less vulnerable to privilege escalation attacks.                                                    
          Details: https://sg.run/eleR                                                                        
                                                                                                              
           ▶▶┆ Autofix ▶ securityContext: allowPrivilegeEscalation: false name
           28┆ name: node-exporter
                                                                                         
    lb_plugins/plugins/dfaas/legacy_materials/samples_generator/restart_data_gathering.sh
    ❯❱ bash.lang.security.ifs-tampering.ifs-tampering
          The special variable IFS affects how splitting takes place when expanding unquoted variables. Don't
          set it globally. Prefer a dedicated utility such as 'cut' or 'awk' if you need to split input data.
          If you must use 'read', set IFS locally using e.g. 'IFS="," read -a my_array'.                     
          Details: https://sg.run/Q9pq                                                                       
                                                                                                             
           37┆ IFS=','; echo "${NAMES[*]}"
            ⋮┆----------------------------------------
           38┆ IFS=','; echo "${RATES[*]}"
                                                                                             
    lb_plugins/plugins/dfaas/legacy_materials/samples_generator/samples-generator-profiler.py
   ❯❯❱ python.lang.security.audit.subprocess-shell-true.subprocess-shell-true
          Found 'subprocess' function 'call' with 'shell=True'. This is dangerous because this call will spawn
          the command using a shell process. Doing so propagates current shell settings and variables, which  
          makes it much easier for a malicious actor to execute commands. Use 'shell=False' instead.          
          Details: https://sg.run/J92w                                                                        
                                                                                                              
           ▶▶┆ Autofix ▶ False
           62┆ subprocess.call(faas_login_cmd, shell=True)
            ⋮┆----------------------------------------
   ❯❯❱ python.lang.security.audit.subprocess-shell-true.subprocess-shell-true
          Found 'subprocess' function 'run' with 'shell=True'. This is dangerous because this call will spawn
          the command using a shell process. Doing so propagates current shell settings and variables, which 
          makes it much easier for a malicious actor to execute commands. Use 'shell=False' instead.         
          Details: https://sg.run/J92w                                                                       
                                                                                                             
           ▶▶┆ Autofix ▶ False
          182┆ subprocess.run(attack_configs[0], shell=True).check_returncode()
                                                                                    
    lb_plugins/plugins/dfaas/legacy_materials/samples_generator/samples-generator.py
   ❯❯❱ python.lang.security.audit.subprocess-shell-true.subprocess-shell-true
          Found 'subprocess' function 'check_output' with 'shell=True'. This is dangerous because this call 
          will spawn the command using a shell process. Doing so propagates current shell settings and      
          variables, which makes it much easier for a malicious actor to execute commands. Use 'shell=False'
          instead.                                                                                          
          Details: https://sg.run/J92w                                                                      
                                                                                                            
           ▶▶┆ Autofix ▶ False
           83┆ openfaas_password_cmd, shell=True, text=True
            ⋮┆----------------------------------------
   ❯❯❱ python.lang.security.audit.subprocess-shell-true.subprocess-shell-true
          Found 'subprocess' function 'Popen' with 'shell=True'. This is dangerous because this call will   
          spawn the command using a shell process. Doing so propagates current shell settings and variables,
          which makes it much easier for a malicious actor to execute commands. Use 'shell=False' instead.  
          Details: https://sg.run/J92w                                                                      
                                                                                                            
           ▶▶┆ Autofix ▶ False
          339┆ subprocess.Popen(attack, shell=True)
                                                                        
    lb_plugins/plugins/dfaas/legacy_materials/samples_generator/utils.py
   ❯❯❱ python.requests.security.disabled-cert-validation.disabled-cert-validation
          Certificate verification has been explicitly disabled. This permits insecure connections to insecure
          servers. Re-enable certification validation.                                                        
          Details: https://sg.run/AlYp                                                                        
                                                                                                              
           ▶▶┆ Autofix ▶ requests.get(url, query_params, verify=True)
          507┆ response = requests.get(url, query_params, verify=False)
                                       
    lb_plugins/plugins/dfaas/queries.py
    ❯❱ python.lang.security.audit.dynamic-urllib-use-detected.dynamic-urllib-use-detected
          Detected a dynamic value being used with urllib. urllib supports 'file://' schemes, so a dynamic    
          value controlled by a malicious actor may allow them to read arbitrary files. Audit uses of urllib  
          calls to ensure user data cannot control the URLs, or consider using the 'requests' library instead.
          Details: https://sg.run/dKZZ                                                                        
                                                                                                              
          169┆ with urlopen(request, timeout=self._timeout_seconds) as response:
                                          
    lb_plugins/plugins/geekbench/plugin.py
   ❯❯❱ trailofbits.python.tarfile-extractall-traversal.tarfile-extractall-traversal
          Possible path traversal through `tarfile.open($PATH).extractall()` if the source tar is controlled
          by an attacker                                                                                    
          Details: https://sg.run/2RLD                                                                      
                                                                                                            
          324┆ with tarfile.open(archive_path, "r:gz") as tar:
          325┆     tar.extractall(path=self.config.workdir)
                
                
┌──────────────┐
│ Scan Summary │
└──────────────┘
Some files were skipped or only partially analyzed.
  Scan was limited to files tracked by git.
  Scan skipped: 1 files larger than 1.0 MB
  For a full list of skipped files, run semgrep with the --verbose flag.

Ran 328 rules on 105 files: 17 findings.

A new version of Semgrep is available. See https://semgrep.dev/docs/upgrading

